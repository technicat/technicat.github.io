---
layout: post
title: Unity 3.5 iAds (corrected)
date: '2012-05-20T15:33:00-07:00'
tags: []
tumblr_url: https://fugugames.tumblr.com/post/110515861126/unity-35-iads-corrected
---
<p>I think Unity 3.5 still has some performance issues on mobile, at least Android, but there are some convenient new features for mobile. On Android, I like the spinning load cursor. On iOS, my favorite new feature is the iAd support. I&rsquo;ve been using the prime31 iAd plugin with no problems, but if the feature is built into Unity, so much the better. I posted my code for bringing up a banner ad a while ago, based on the example in the Unity script reference, but I made a crucial error - I thought I improved the code by moving the banner variable declaration into the ShowBanner function, but that allows it to get garbage collected, and after a while the ad stops refreshing (that is the second garbage-collection error I&rsquo;ve made in the last few months - as a one-time Lisp programmer, I&rsquo;m quite embarrassed). So here&rsquo;s the corrected version:</p>

<p><code></code></p>

<p>var banner:ADBannerView;</p>

<p>function Start () {<br/>
GameObject.DontDestroyOnLoad(this);<br/>
StartCoroutine(ShowBanner());<br/>
}</p>

<p>function ShowBanner() {<br/>
banner = new ADBannerView();<br/>
banner.autoSize = true;<br/>
banner.autoPosition = ADPosition.Top;<br/>
while (!banner.loaded &amp;&amp; banner.error == null)<br/>
yield;</p>

<p>if (banner.error == null)<br/>
banner.Show();<br/>
else banner = null;<br/>
}<br/></p>

<p>I&rsquo;ve tested that code in a submitted app, <a href="http://itunes.apple.com/us/app/fugu-match/id450691603">Fugu Match</a>, and the revenue is coming in, so it seems to be working fine.</p>

<p>There&rsquo;s also support for interstitial ads, which I&rsquo;d forgotten I added to <a href="http://itunes.apple.com/app/fugu-type/id361179164">Fugu Type</a> (I only realized it when I saw I was getting a little bit of ad revenue). I don&rsquo;t see a code example in the script reference, but here&rsquo;s what I&rsquo;m using, which is pretty simple.</p>

<p><code><br/>
function Start() {<br/>
if (iPhone.generation == iPhoneGeneration.iPad1Gen || iPhone.generation == iPhoneGeneration.iPad2Gen || iPhone.generation == iPhoneGeneration.iPad3Gen) {<br/>
var ad = new ADInterstitialAd();<br/>
while (!ad.loaded) yield;<br/>
ad.Present();<br/>
}<br/>
}<br/></code></p>
